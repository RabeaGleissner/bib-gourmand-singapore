import React from "react"
import GoogleMap from "./GoogleMap"
import styles from "./googleMapStyles"
import "./map.css"

const singaporeCoords = {
  lat: 1.3521,
  lng: 103.8198,
}

const mapOptions = {
  center: singaporeCoords,
  styles,
}

const path = `M168.071 19.654 C 160.594 23.051,151.527 29.578,147.924 34.159 C 144.320 38.741,132.941 46.478,122.637 51.352 C 84.119 69.574,61.268 103.321,57.624 147.365 C 55.896 168.264,54.014 173.767,44.184 186.667 C 11.215 229.934,16.212 275.336,58.735 318.892 C 71.763 332.236,78.588 336.856,84.111 336.072 C 98.110 334.085,95.191 322.301,75.895 302.897 C 37.079 263.866,35.462 223.777,71.349 190.252 C 78.991 183.114,80.000 179.574,80.000 159.916 C 80.000 106.643,107.954 74.280,164.826 61.713 C 171.585 60.220,173.304 58.708,170.332 56.872 C 149.808 44.187,200.535 29.145,223.333 41.155 C 231.800 45.615,232.256 47.139,228.224 57.500 C 226.442 62.078,227.696 63.333,234.050 63.333 C 278.718 63.333,317.429 107.409,318.139 159.076 C 318.456 182.126,318.993 183.689,330.739 195.743 C 363.247 229.104,359.988 264.387,320.717 304.221 C 304.910 320.255,302.372 324.399,305.408 329.221 C 312.441 340.389,320.248 337.790,339.667 317.815 C 383.588 272.636,387.383 224.974,350.433 182.593 C 342.191 173.139,340.691 168.220,339.304 146.091 C 336.533 101.890,314.645 69.447,275.400 51.375 C 266.013 47.053,253.879 38.761,248.435 32.949 C 229.621 12.863,195.465 7.213,168.071 19.654 M125.010 110.990 C 100.834 135.166,100.834 181.501,125.010 205.677 C 158.120 238.786,202.899 193.767,190.065 140.272 C 180.864 101.915,148.605 87.395,125.010 110.990 M231.697 107.238 C 195.429 135.767,209.414 216.667,250.615 216.667 C 275.510 216.667,293.740 192.320,294.042 158.669 C 294.442 114.231,259.477 85.387,231.697 107.238 M164.954 113.893 C 181.786 127.133,188.359 157.921,179.674 182.836 C 174.722 197.041,171.699 196.024,171.508 180.089 C 171.324 164.783,159.221 149.124,148.790 150.695 C 138.563 152.235,129.091 167.802,129.091 183.070 C 129.091 199.288,128.382 199.652,121.752 186.832 C 101.313 147.306,135.040 90.363,164.954 113.893 M269.676 114.435 C 283.868 126.173,289.932 156.661,282.806 180.447 C 277.792 197.182,273.333 196.900,273.333 179.848 C 273.333 165.615,262.146 150.000,251.948 150.000 C 239.756 150.000,226.958 175.164,231.643 189.925 C 235.151 200.978,227.853 197.560,222.904 185.833 C 204.504 142.224,239.214 89.238,269.676 114.435 M237.638 240.833 C 227.657 251.748,221.354 265.739,216.439 287.886 L 212.100 307.440 195.159 305.449 C 169.871 302.476,148.774 294.231,138.190 283.184 C 127.856 272.397,121.699 270.765,118.896 278.069 C 110.571 299.762,180.830 325.216,227.123 317.278 C 259.649 311.700,300.000 290.043,300.000 278.164 C 300.000 271.848,288.640 271.939,283.364 278.297 C 277.375 285.513,274.770 282.260,273.834 266.399 C 272.043 236.036,253.803 223.154,237.638 240.833`

const icon = {
  path,
  fillColor: `darkblue`,
  fillOpacity: .8,
  strokeWeight: 0,
  scale: .1,
  rotation: 0,
}

const addRestaurants = (restaurants) => map => {
  restaurants.forEach((restaurant, index) => {
    const  infowindow = new window.google.maps.InfoWindow({
      content: `<div class='map-info-window'><h3 class='map-info-window-title'>${restaurant.name}</h3></div>`,
    });
    const marker = new window.google.maps.Marker({
      map,
      icon,
      position: restaurant.coords,
      draggable: false,
    })
    marker.addListener('click', () => {
      infowindow.open(map, marker);
      window.google.maps.event.addListener(map, 'click', () => {
        infowindow.close();
      });
    })
  })
}

const RestaurantMap = ({ restaurants }) => {
  return (
    <GoogleMap
      onMount={addRestaurants(restaurants)}
      mapOptions={mapOptions}
    />
  )
}

export default RestaurantMap
